<!DOCTYPE html>
<html lang="en">
    <head>    
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Control del cono</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="../apple-touch-icon.png">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <link rel="stylesheet" href="../css/bootstrap.min.css">
       
        <link rel="stylesheet" href="../css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="../css/main.css">
        <link href="https://fonts.googleapis.com/css?family=Heebo:100,300,400,500" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Trirong:100,300,400,500" rel="stylesheet">
        <link rel="stylesheet" href="../fonts/font-awesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
      <style>
              html, body {
                height: 100%;
                margin: 0;
                padding: 0;
              }
              h1{
                font-size:17pt;
              }
              h3{
                font-size:16pt;
              }
              h4{
                font-size:14pt;
              }
        </style>   
	<script src="/socket.io/socket.io.js"> </script>
	<script>
	  //use http://raspberryPi.local if your using Avahi Service 
	      //or use your RasperryPi IP instead
	      var socket = io.connect('http://raspberrypi.local:8080');
	  socket.on('connect', function(data){
	      socket.emit('remote');
	  });
	</script>     
    </head>
    <body>
        <header>
   <nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
     <a href="index.html"><img class="img-responsive logo" src="../img/logo_logicalis.svg"></a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
       <li class="active"><a class="noborder" href="../index.html">Home<span class="sr-only">(current)</span></a></li>
        <li><a class="noborder" href="http://www.la.logicalis.com/contact/argentina/" target="_blank">Contacto</a></li>
        <!--<li><a href="#"><i class="fa fa-volume-up" aria-hidden="true"></i></a></li>-->
       
      </ul>
     
      
    </div><!-- /.navbar-collapse -->
    
  </div><!-- /.container -->
   <div class="leftleave">
 <img src="../img/leave-left.png" class="leftleaveimg">
 </div>
    <div class="rightleave">
 <img src="../img/rightcoconuts.png" class="rightleaveimg">
 </div>
</nav>
 <div id="tagline">
<div class="col-md-3"></div>
<div class="col-md-6"> <img src="../img/tagline.png" class="img-responsive"></div>
<div class="col-md-3"></div>
</div> 
 
</header>
  <div class="container">
    <section id="intern_section">
        <div class="row">
          <div class="col-md-6 col-md-offset-5">
            <button type="button" class="logicalisbutton" onclick='play()'><i class="fa fa-play"></i></button>
            <button onclick="pause();" class="logicalisbutton"><i class="fa fa-pause"></i></button>
          </div>
        </div> 
        <div style="margin-top:5px;" class="row">
          <div class="col-md-6 col-md-offset-5">
            <button type="button" class="logicalisbutton" onclick='previous()'><i class="fa fa-fast-backward"></i></button>
            <button onclick="next();" class="logicalisbutton"><i class="fa fa-fast-forward"></i></button>
          </div>
        </div>
        <div style="margin-top:5px;" class="row">
          <div class="col-md-6 col-md-offset-5">
            <input id="seconds" size="7" maxlength="4" type="text"/>
            <button style="padding:7px;font-size:18px;"onclick="setSeconds();" class="logicalisbutton">Setear segundos</button>
          </div>
        </div>
        <div style="margin-top:5px;" class="row">
            <div class="col-md-6 col-md-offset-3">
                <form action="#">
                    <p><input type="text" id="search" placeholder="Type something..." autocomplete="off" class="form-control" /></p>
                    <p><input type="submit" value="Search" class="form-control btn btn-primary w100"></p>
                </form>
                <div id="results"></div>
            </div>
        </div>
     </section>
    <hr>
    </div>
<footer class="container-fluid">
    <div class="container-fluid leftcero">
      <div class="col-md-4 leftcero"><a href="http://www.la.logicalis.com/" target="_blank"><img class="img-responsive logo_footer" src="../img/logo_logicalis.svg"></a></div>
       <div class="col-md-4"><img class="img-responsive palmera" src="../img/palmera.svg"></div>
      <div class="col-md-4">
      <div class="rightfloat">
      <a class="socialmedia noborder" href="https://www.youtube.com/user/LogicalisLatam" target="_blank"><i class="fa fa-youtube" aria-hidden="true"></i></a>
      <a class="socialmedia noborder"  href="https://www.facebook.com/LogicalisLatam" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
       <a class="socialmedia noborder"  href="https://twitter.com/logicalislatam" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
       <a class="socialmedia noborder"  href="https://www.linkedin.com/company/logicalis" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
       <a class="socialmedia noborder"  href="http://www.la.logicalis.com/news/rss/" target="_blank"><i class="fa fa-rss" aria-hidden="true"></i></a>
       <a class="link_footer noborder" href="http://www.la.logicalis.com/contact/argentina/" target="_blank">CONTACTO</a></div>
    </div>
    </div>
       
    </footer> <!-- /container -->      
        
        <!-- scripts -->
        <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
        <script>
        var id = null;
        var wsUri = "ws://1e98cc4a.ngrok.io";
        var websocket;
        initWebSocket();
        function initWebSocket()
        {
            websocket = new WebSocket(wsUri);
            websocket.onopen = function(evt) { onOpen(evt) };
            websocket.onclose = function(evt) { onClose(evt) };
            websocket.onmessage = function(evt) { onMessage(evt) };
            websocket.onerror = function(evt) { onError(evt) };
        }

        function onOpen(evt)
        {
            console.log("CONNECTED");
        }

        function onClose(evt)
        {
            console.log("Disconnected");
        }
        function onError(evt)
        {
            console.log('Websocket Error:' + evt.data);
        }
        function onMessage(evt)
        {
            console.log(evt.data);
            var r = JSON.parse(evt.data);
            if (r.msgtype == "handshake"){
              id = r.message;
              websocket.send('{"msgtype": "handshake", "from": "control", "id":' + id +'}')
            }


        }

        function tplawesome(e,t){res=e;for(var n=0;n<t.length;n++){res=res.replace(/\{\{(.*?)\}\}/g,function(e,r){return t[n][r]})}return res}
          $(function() {
    $("form").on("submit", function(e) {
       e.preventDefault();
       // prepare the request
       var request = gapi.client.youtube.search.list({
            part: "snippet",
            type: "video",
            q: encodeURIComponent($("#search").val()).replace(/%20/g, "+")
       }); 
       // execute the request
       request.execute(function(response) {
          var results = response.result;
          $("#results").html("");
          $.each(results.items, function(index, item) {
            $("#results").append(`
              <div class="item">
                <h4>` + item.snippet.title + `</h4>
                <img class="videoimg" id="` + item.id.videoId + `" center width="60%" height="60%" src="`+ item.snippet.thumbnails.high.url +`"/><button class="playlist" onclick="addToPlaylist(\'`+ item.id.videoId + `\')" style="margin-left:10px;padding:5px" class="logicalisbutton"><!-- Playlist icon by Icons8 --><!-- Video Playlist icon by Icons8 -->
<img class="icon icons8-Video-Playlist" width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAABV0lEQVRoQ+2Z/RHBQBDFXzrRASqgFR3QAR3QCRWgAypAB1TArLnLmGFyudjb+8jev7ns7m/fvksmqVDIqgrhgIKkpmSvFbkAGARW5ARg7JOjiyKUZOiTpMPeM4CRz31dQHzii+3tDYiEH9qq1ugblyISfmgL0ugbF0jbJNH3FQmyBzCN3lq/AmrffCry9IuRzO43wy+QXMbNNl5BUpkpVSQVJWwdqogqEqgDwUdrDWAL4BAIQMwjBDAxMAsA10BAwRWxILZ+UmgF4M4MJA5C9RPEEsCGESYKiK2fxmzG5J+oIBaIxo/8Q6/hXVcSIEcA85xBbgaAjud/VxRFHsbsdIJxLXEQOqnoxMr2+N2ZMcr2gVjMKwqXB1xxgnvEVQDXdQXh6iRXHFWEq5NccVQRrk5yxXEqwpVIKs7Xt9+U/k61bUL9FyuXL+9OMAVxtkh4gyoi3HBnuhfsimgz1sowIQAAAABJRU5ErkJggg=="></button>
              </div>`
            );
          });
          resetVideoHeight();
       });
    });
    
    $(window).on("resize", resetVideoHeight);
});

$(document).on("mouseover", "#results .videoimg", function(){
  $(this).css("border", "2px solid green");
});

$(document).on("mouseout", "#results .videoimg", function(){
  $(this).css("border", "none");
});


$(document).on("click", "#results .videoimg", function(){
  socket.emit('control',{action:"swipeLeft"}); 
  var data = {};
  data.msgtype = "message";
  data.id = id;      
  data.command = "changeVideo";
  data.parameter = $(this).attr('id');
  websocket.send(JSON.stringify(data));
});

function pause(){
  var data = {};
  data.msgtype = "message";
  data.id = id;      
  data.command = "pauseVideo";
  websocket.send(JSON.stringify(data));
}

function play(){
  var data = {};
  data.msgtype = "message";
  data.id = id;      
  data.command = "playVideo";
  websocket.send(JSON.stringify(data));
}

function setSeconds(){
  var data = {};
  data.msgtype = "message";
  data.id = id;      
  data.command = "setSeconds";
  data.parameter = $("#seconds").val();
  websocket.send(JSON.stringify(data));
}

function addToPlaylist(videoId){
  var data = {};
  data.msgtype = "message";
  data.id = id;      
  data.command = "addToPlaylist";
  data.parameter = videoId;
  websocket.send(JSON.stringify(data));
}

function previous(){
  var data = {};
  data.msgtype = "message";
  data.id = id;      
  data.command = "previous";
  websocket.send(JSON.stringify(data));
}

function next(){
  var data = {};
  data.msgtype = "message";
  data.id = id;      
  data.command = "next";
  websocket.send(JSON.stringify(data));
}

function resetVideoHeight() {
    $(".video").css("height", $("#results").width() * 9/16);
}

function init() {
    gapi.client.setApiKey("AIzaSyD_zPVyqYkkEeORp73YHWbHnvuNfq-tKZE");
    gapi.client.load("youtube", "v3", function() {
        // yt api is ready
    });
}


        </script>
        <script src="https://apis.google.com/js/client.js?onload=init"></script>
    </body>
</html>